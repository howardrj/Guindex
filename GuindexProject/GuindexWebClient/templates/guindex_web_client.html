<!DOCTYPE html>
<html lang="en">

{% load static %}

<head>
  <script>
    var G_GUINDEX_DEBUG = ('{{debug}}' == 'True')
  </script>
  <script>
    window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;

    ga('create', '{{ google_analytics_key }}', 'auto'); 

  </script>

  <!-- Firebase auth related tags -->
  <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/ui/6.0.0/firebase-ui-auth.js"></script>
  <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/6.0.0/firebase-ui-auth.css" />

  <script async src='https://www.google-analytics.com/analytics.js'></script>
  <script type="text/javascript" src="{% static "javascript/lib/jquery.min.js" %}"></script>
  <script type="text/javascript" src="{% static "javascript/lib/bootstrap.bundle.min.js" %}"></script>
  <script type="text/javascript" src="{% static "javascript/lib/jquery.easing.min.js" %}"></script>
  <script type="text/javascript" src="{% static "javascript/lib/Chart.min.js" %}"></script>
  <script type="text/javascript" src="{% static "javascript/lib/jquery.dataTables.js" %}"></script>
  <script type="text/javascript" src="{% static "javascript/lib/dataTables.bootstrap4.js" %}"></script>
  <script type="text/javascript" src="{% static "javascript/lib/sb-admin.min.js" %}"></script>
  <script type="text/javascript" src="{% static "javascript/lib/sb-admin-datatables.min.js" %}"></script>
  <script type="text/javascript" src="{% static "javascript/guindex_user.js" %}"></script>
  <script type="module" src="{% static "javascript/guindex_firebase_auth.js" %}"></script>
  <script type="text/javascript" src="{% static "javascript/lib/particles.js" %}"></script>
  <script src="https://apis.google.com/js/platform.js" async defer></script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <title> Guindex </title>
  <link rel="icon" href="{% static "images/favicon.png" %}">
  <link rel="stylesheet" href="{% static "css/lib/bootstrap.min.css" %}">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="{% static "css/lib/dataTables.bootstrap4.css" %}">
  <link rel="stylesheet" href="{% static "css/lib/sb-admin.css" %}">
  <link rel="stylesheet" href="{% static "css/guindex_web_client.css" %}">
	
</head>

<body class="fixed-nav sticky-footer" id="page-top">

  <div id="particles_js_container">
    <div id="main_loader_container">
        <i id="main_loader_spinner" class="fa fa-spinner fa-spin guindex_web_client_loader"></i>
        <span class="blink"> Loading guindex.ie ...</span>
    </div> 
  </div>

  <script>
    particlesJS.load('particles_js_container', '/static/javascript/lib/particles.json', function() {
        return;
    });
  </script>

  <!-- Navigation-->
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top" style="background-color:black;" id="mainNav">
    <a class="navbar-brand" href="">
        <img src="{% static "images/black_guindex_logo.jpeg" %}" alt="Guindex" width="150" height="30">
    </a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav navbar-sidenav" id="exampleAccordion" style="background-color:black">
        <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Overview">
          <a class="nav-link page_content_link" data-content_page_id="overview_page">
            <i class="fa fa-fw fa-home"></i>
            <span class="nav-link-text">Home</span>
          </a>
        </li>
	    <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Map">
          <a class="nav-link page_content_link" data-content_page_id="map_page">
            <i class="fa fa-fw fa-map-o"></i>
            <span class="nav-link-text">Map</span>
          </a>
        </li>
	<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Data">
          <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseData" data-parent="#exampleAccordion">
            <i class="fa fa-fw fa-table"></i>
            <span class="nav-link-text">Pubs & Prices</span>
          </a>
          <ul class="sidenav-second-level collapse" id="collapseData" style="background-color:black">
            <li>
              <a class="nav-link page_content_link" data-content_page_id="data_table_page"> Current Database </a>
            </li>
            <li>
              <a class="nav-link page_content_link" data-content_page_id="data_add_pub_page"> Add a Pub </a>
            </li>
          </ul>
        </li>
        <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Contributions">
          <a class="nav-link page_content_link" data-content_page_id="contributions_page">
            <i class="fa fa-fw fa-user"></i>
            <span class="nav-link-text">Contributions</span>
          </a>
        </li>
        <li id="pending_contributions_li" class="nav-item" data-toggle="tooltip" data-placement="right" title="Pending Contributions" style="display:none">
          <a class="nav-link page_content_link" data-content_page_id="pending_contributions_page">
            <i class="fa fa-fw fa-clock-o"></i>
            <span class="nav-link-text">Pending Contributions</span>
          </a>
        </li>
	<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Statistics">
          <a class="nav-link page_content_link" data-content_page_id="statistics_page">
            <i class="fa fa-fw fa-dashboard"></i>
            <span class="nav-link-text">Statistics</span>
          </a>
        </li>
	<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Analysis">
          <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseAnalysis" data-parent="#exampleAccordion">
            <i class="fa fa-fw fa-area-chart"></i>
            <span class="nav-link-text">Analysis</span>
          </a>
          <ul class="sidenav-second-level collapse" id="collapseAnalysis" style="background-color:black">
            <li>
              <a class="nav-link page_content_link" data-content_page_id="analysis_main_page">Analysis Overview</a>
            </li>
            <li>
              <a class="nav-link page_content_link" data-content_page_id="analysis_risingseas_page">Dublin Pintscape in a Warmer World</a>
            </li>
	    <li>
              <a class="nav-link page_content_link" data-content_page_id="analysis_travelling_drunkard_page">Travelling Drunkard</a>
            </li>
            <li>
              <a class="nav-link page_content_link" data-content_page_id="analysis_social_page">Correlation of Socioeconomic Factors and Guinness Pricing</a>
            </li>
            <li>
              <a class="nav-link page_content_link" data-content_page_id="analysis_geo_page">Geographic Variation of Guinness Pricing</a>
            </li>
            <li>
              <a class="nav-link page_content_link" data-content_page_id="analysis_pubdist_page">Furthest Distance to a Pub in County Dublin</a>
            </li>
          </ul>
        </li>
	 <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Settings">
          <a class="nav-link page_content_link" data-content_page_id="settings_page">
            <i class="fa fa-fw fa-wrench"></i>
            <span class="nav-link-text">Settings</span>
          </a>
        </li>
        <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Links">
          <a class="nav-link page_content_link" data-content_page_id="links_page">
            <i class="fa fa-fw fa-link"></i>
            <span class="nav-link-text">Links</span>
          </a>
        </li>

        <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Info">
          <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseInfo" data-parent="#exampleAccordion">
            <i class="fa fa-fw fa-info-circle"></i>
            <span class="nav-link-text">Info</span>
          </a>
          <ul class="sidenav-second-level collapse" id="collapseInfo" style="background-color:black">
            <li>
              <a class="nav-link page_content_link" data-content_page_id="info_introduction_page">Introduction</a>
            </li>
            <li>
              <a class="nav-link page_content_link" data-content_page_id="info_about_page">History</a>
            </li>
      	    <li>
              <a class="nav-link page_content_link" data-content_page_id="info_faq_page">Submissions FAQ</a>
            </li>	
            <li>
              <a class="nav-link page_content_link" data-content_page_id="info_privacy_page">Privacy Policy</a>
            </li>
            <li>
              <a class="nav-link page_content_link" data-content_page_id="info_tos_page">Terms of Service</a>
            </li>
          </ul>
        </li>

        <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Help">
          <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseHelp" data-parent="#exampleAccordion">
            <i class="fa fa-fw fa-question-circle"></i>
            <span class="nav-link-text">Help</span>
          </a>
          <ul class="sidenav-second-level collapse" id="collapseHelp" style="background-color:black">
            <li>
              <a class="nav-link page_content_link" data-content_page_id="help_contact_page">Contact</a>
            </li>
            <li>
              <a class="nav-link page_content_link" data-content_page_id="help_api_page">Guindex API</a>
            </li>
          </ul>
        </li>

      </ul>
      <ul class="navbar-nav sidenav-toggler" style="background-color: black">
        <li class="nav-item">
          <a class="nav-link text-center" id="sidenavToggler">
            <i class="fa fa-fw fa-angle-left"></i>
          </a>
        </li>
      </ul>
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" data-toggle="modal" id="login_link" data-target="#login_modal" >
            <i class="fa fa-fw fa-sign-in"></i>
              Account
           </a>
          <a class="nav-link" data-toggle="modal" id="logout_link" data-target="#logout_modal" style="display:none" >
           </a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Content Pages -->
  {% include "overview.html" %}
  {% include "statistics.html" %}
  {% include "map.html" %}
  {% include "analysis_main.html" %}
  {% include "analysis_risingseas.html" %}
  {% include "analysis_travelling_drunkard.html" %}
  {% include "analysis_social.html" %}
  {% include "analysis_geo.html" %}
  {% include "analysis_pubdist.html" %}
  {% include "data_table.html" %}
  {% include "data_add_pub.html" %}
  {% include "contributions.html" %}
  {% include "pending_contributions.html" %}
  {% include "settings.html" %}
  {% include "links.html" %}
  {% include "info_introduction.html" %}
  {% include "info_about.html" %}
  {% include "info_faq.html" %}
  {% include "info_privacy.html" %}
  {% include "info_tos.html" %}
  {% include "help_contact.html" %}
  {% include "help_api.html" %}

  <footer class="sticky-footer" style="background-color:black; color: white;">
    <div class="container">
      <div class="text-center">
        <small>Copyright © guindex.ie {% now "Y" %}</small>
      </div>
    </div>
  </footer>
  <!-- Scroll to Top Button-->
  <a class="scroll-to-top rounded" style="background-color:black" href="#page-top">
    <i class="fa fa-angle-up"></i>
  </a>

  <!-- Login Modal-->
  <div class="modal fade" id="login_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
            <div id="logged_out_modal_header">
                Login
            </div>
            <div id="logged_in_modal_header" style="display:none">
                Logout
            </div>

          <button class="close" id="login_close_button" type="button" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">×</span>
          </button>
        </div>

        <div class="modal-body" id="firebase_auth_modal_body">
            <div id="logged_out_modal_body">
                Choose your login method from the options available below.
                You will need to login to submit new pint prices.
                <div id="firebaseui-auth-container"></div>
            </div>
            <div id="logged_in_modal_body" style="display:none">
                <div>
                    Logged in as <span id="logged_in_modal_body_username" style="font-weight:bold"> </span>.
                    Click the button below to log out.
                </div>
            </div>
        </div>            
        <div class="modal-footer">
            <div id="logged_out_modal_footer">
            </div>
            <div id="logged_in_modal_footer" style="display:none">
                <a class="btn btn-primary" id="logout_button" style="color:white">Logout</a>
                <i class="fa fa-spinner fa-spin guindex_web_client_loader"></i>
            </div>
        </div>
     </div>
   </div>
 </div>

  <!-- Generic Message Modal (with hidden button to open it)-->
  <a class="nav-link" data-toggle="modal" id="message_link" data-target="#message_modal" style="display:none"></a>

  <div class="modal fade" id="message_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" style="z-index:9999">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="message_severity"></h5>
          <button class="close" type="button" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-body" id="message_body">

        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" type="button" data-dismiss="modal">OK</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Pending Contribution Reject Reason Modal (with hidden button to open it)-->
  <a class="nav-link" data-toggle="modal" id="reject_reason_link" data-target="#reject_reason_modal" style="display:none"></a>

  <div class="modal fade" id="reject_reason_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" style="z-index:9999">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="message_severity"> Reject Reason </h5>
          <button class="close" type="button" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-body">
            Include an (optional) reason for rejecting this pending contribution:
            <textarea id="reject_reason_text_area" style="margin: 10px auto; display:block; position:relative">

            </textarea>
        </div>
        <div class="modal-footer">
          <i class="fa fa-spinner fa-spin guindex_web_client_loader"></i>
          <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
          <button id="final_reject_submit_button" class="pending_contribution_button btn btn-primary" type="button" data-dismiss="modal">Submit</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Pub Modal (with hidden button to open it)-->
  <!-- TODO Need to clean this up to look more like the otehr forms (using form-groups etc.) -->
  <a class="nav-link" data-toggle="modal" id="edit_pub_link" data-target="#edit_pub_modal" style="display:none"></a>

  <div class="modal fade" id="edit_pub_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" style="z-index:9999">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="message_severity"> Edit Pub </h5>
          <button class="close" type="button" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-body">

            <p> Change the value of any fields below you would like to edit: </p>

            <table align="left" border="0">

                <tr>
                    <td> Name:</td>
                    <td> <input type="text" id="edit_pub_name"> </td>
                </tr>

                <tr>
                    <td> Latitude:</td>
                    <td> <input type="number" step=0.0000001 id="edit_pub_latitude"> </td>
                </tr>

                <tr>
                    <td> Longitude:</td>
                    <td> <input type="number" step=0.0000001 id="edit_pub_longitude"> </td>
                </tr>

                <tr>
                    <td> County:</td>
                    <td> 
    			        <select class="form-control" id="edit_pub_county">
                            {% for county in guindex_counties %}
                                <option> {{ county }} </option>
                            {% endfor %}
    			        </select>
                    </td>
                </tr>

                <tr>
                    <td> Closed:</td>
                    <td>
				        <label class="switch">
                            <input type="checkbox" id="edit_pub_closed" class="hoverable">
                	        <div id="edit_pub_closed_switch_div" class="slider round"> </div>
              	        </label>
                    </td>
                </tr>

                <tr>
                    <td> Serving Guinness:</td>
                    <td>
				        <label class="switch">
                            <input type="checkbox" id="edit_pub_serving_guinness" class="hoverable">
                	        <div id="edit_pub_serving_guiness_switch_div" class="slider round"> </div>
              	        </label>
                    </td>
                </tr>

            </table>

        </div>
        <div class="modal-footer">
          <i class="fa fa-spinner fa-spin guindex_web_client_loader"></i>
          <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
          <button id="edit_pub_submit_button" class="btn btn-primary" type="button" data-dismiss="modal">Submit</button>
        </div>
      </div>
    </div>
  </div>

  {% if not debug %}
    <script type="text/javascript" src="{% static "javascript/guindex_web_client_utils.min.js" %}"></script>
    <script type="text/javascript" src="{% static "javascript/guindex_main.min.js" %}"></script>
    <script type="text/javascript" src="{% static "javascript/guindex_page_manager.min.js" %}"></script>
  {% else %}
    <script type="text/javascript" src="{% static "javascript/guindex_web_client_utils.js" %}"></script>
    <script type="text/javascript" src="{% static "javascript/guindex_main.js" %}"></script>
    <script type="text/javascript" src="{% static "javascript/guindex_page_manager.js" %}"></script>
  {% endif %}

  <script>
    // Close dropdown when new page is opened

    $(".nav-item").on("click", function(evt) {        

        var node = evt.target;

        while (!node.classList.contains('nav-item'))
        {
            node = node.parentNode;
        }

        // Don't close menu if link is collapsable
        if (node.children[0].classList.contains('nav-link-collapse') || evt.target.classList.contains('login_state_link'))
            return;
        
        if($('.navbar-toggler').is(':visible'))
        {    
            $(".navbar-toggler").trigger('click');
        }
    });

    $(".nav-link").on("click", function(evt) {        

        if (!evt.target.classList.contains('page_content_link') || evt.target.classList.contains('login_state_link'))
            return;

        if($('.navbar-toggler').is(':visible'))
        {    
            $(".navbar-toggler").trigger('click');
        }
    });
  </script>

  <script>

    function clearLoader ()
    {
        $('#particles_js_container').delay(1000).fadeOut('slow');
    }

    setTimeout(clearLoader, 3000);

   </script>

  </div>

</body>

</html>
